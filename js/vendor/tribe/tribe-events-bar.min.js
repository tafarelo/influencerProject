"use strict";var tribe_events_bar_action,debug;!function(a,b,c,d,e,f,g,h,i){c(b).ready(function(){function j(a){if(!a.parents(".tribe-bar-disabled").length){var b=a.width();b>800?a.removeClass("tribe-bar-mini tribe-bar-collapse").addClass("tribe-bar-full"):a.removeClass("tribe-bar-full").addClass("tribe-bar-mini"),728>b?a.removeClass("tribe-bar-mini").addClass("tribe-bar-collapse"):a.removeClass("tribe-bar-collapse")}}function k(){if(tribe_events_bar_action="change_view","month"===g.view&&m.length){var d=m.val(),i=f.get_day();"0"!==g.datepicker_format?i.length?(d=tribeDateFormat(m.bootstrapDatepicker("getDate"),"tribeMonthQuery"),m.val(d+i)):m.val(""):7===d.length&&m.val(d+i)}g.url_params={},c(e).trigger("tribe_ev_preCollectBarParams"),c(e).trigger("pre-collect-bar-params.tribe");var j=c(b.getElementById("tribe-bar-form")).add(b.getElementById("tribe_events_filters_wrapper")),k=j.find("input, select");k.each(function(){var a=c(this);a.val()&&a.val().length&&!a.hasClass("tribe-no-param")&&("month"!==g.view&&"0"!==g.datepicker_format&&a.is(m)?g.url_params[a.attr("name")]=tribeDateFormat(a.bootstrapDatepicker("getDate"),"tribeQuery"):a.is(":checkbox")?a.is(":checked")&&(g.url_params[a.attr("name")]=a.val()):g.url_params[a.attr("name")]=a.val())}),g.url_params=c.param(g.url_params),c(e).trigger("tribe_ev_postCollectBarParams"),c(e).trigger("post-collect-bar-params.tribe"),g.url_params.length&&(g.cur_url+=h.starting_delim()+g.url_params),a.location.href=g.cur_url}i&&(c().bootstrapDatepicker||debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-events-bar.js"),c().placeholder||debug.warn("TEC Debug: vendor placeholder was not loaded before its dependant file tribe-events-bar.js"));var l=c("#tribe-bar-form"),m=c("#tribe-bar-date"),n=(c("#tribe-events"),c("#tribe-events-header")),o=0,p=c("select[name=tribe-bar-view]");if(n.length&&(o=n.data("startofweek")),j(l),l.resize(function(){j(l)}),!c(".tribe-events-week-grid").length&&"month"!==g.view){var q="yyyy-mm-dd";if("0"!==g.datepicker_format){q=d.datepicker_formats.main[g.datepicker_format];var r=f.get_url_param("tribe-bar-date");r?m.val(tribeDateFormat(r,g.datepicker_format)):"day"===g.view&&0!==m.val().length&&m.val(tribeDateFormat(m.val(),g.datepicker_format))}i&&debug.info('TEC Debug: bootstrapDatepicker was just initialized in "tribe-events-bar.js" on:',m),d.datepicker_opts={weekStart:o,format:q,autoclose:!0},m.bootstrapDatepicker(d.datepicker_opts)}m.blur(function(){""===m.val()&&c(".datepicker.dropdown-menu").is(":hidden")&&h.live_ajax()&&h.pushstate&&(g.date=d.cur_date,d.cur_url=d.base_url,c(e).trigger("tribe_ev_runAjax"),c(e).trigger("run-ajax.tribe"))}),c(".tribe-bar-settings").length&&c("#tribe-events-bar").addClass("tribe-has-settings"),c("#tribe-events-bar .hasDatepicker").length&&c("#tribe-events-bar").addClass("tribe-has-datepicker"),c('input[name*="tribe-bar-"]').placeholder(),c('<ul class="tribe-bar-views-list" />').insertAfter(p);var s=c(".tribe-bar-views-list");p.find("option").each(function(a){var b=c(this),d=b.data("view"),e="tribe-bar-views-option-"+b.data("view");c("<li></li>",{class:"tribe-bar-views-option "+e,"data-tribe-bar-order":a,"data-view":d}).html(['   <a href="#">','   <span class="tribe-icon-'+d+'">'+b.text()+"</span>","</a>"].join("")).appendTo(".tribe-bar-views-list")});var t=p.find(":selected").data("view"),u=s.find("li[data-view="+t+"]");u.prependTo(s).addClass("tribe-bar-active"),l.on("click","#tribe-bar-views",function(a){a.stopPropagation();var b=c(this);b.toggleClass("tribe-bar-views-open")}),l.on("click",".tribe-bar-views-option",function(a){a.preventDefault();var b=c(this);if(!b.is(".tribe-bar-active")){var d=b.data("view");g.cur_url=c("option[data-view="+d+"]").val(),g.view_target=c('select[name=tribe-bar-view] option[value="'+g.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",k()}}),f.maybe_default_view_change(),l.on("change",".tribe-bar-views-select",function(a){a.preventDefault();var b=c("option:selected",this),d=b.data("view");g.cur_url=c("option[data-view="+d+"]").val(),g.view_target=c('select[name=tribe-bar-view] option[value="'+g.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",k()}),l.on("click","#tribe-bar-collapse-toggle",function(){c(this).toggleClass("tribe-bar-filters-open"),c(".tribe-bar-filters").slideToggle("fast")}),c('label[for="tribe-bar-date"], input[name="tribe-bar-date"]').wrapAll('<div id="tribe-bar-dates" />'),c("#tribe-bar-filters").before(c("#tribe-bar-dates")),c(e).on("tribe_ev_serializeBar",function(){c("form#tribe-bar-form input, form#tribe-bar-form select, #tribeHideRecurrence").each(function(){var a=c(this);if(a.is("#tribe-bar-date")){var b=a.val();b.length?"month"===g.view?(g.params[a.attr("name")]=tribeDateFormat(g.mdate,"tribeMonthQuery"),g.url_params[a.attr("name")]=tribeDateFormat(g.mdate,"tribeMonthQuery")):b.match(/[0-9]{4}-[0-9]{2}/)?g.params[a.attr("name")]=g.url_params[a.attr("name")]=b:(g.params[a.attr("name")]=tribeDateFormat(a.bootstrapDatepicker("getDate"),"tribeQuery"),g.url_params[a.attr("name")]=tribeDateFormat(a.bootstrapDatepicker("getDate"),"tribeQuery")):a.is(".placeholder")&&a.is(".bd-updated")?g.url_params[a.attr("name")]=a.attr("data-oldDate"):g.date=d.cur_date}!a.val().length||a.hasClass("tribe-no-param")||a.is("#tribe-bar-date")||(a.is(":checkbox")?a.is(":checked")&&(g.params[a.attr("name")]=a.val(),"map"!==g.view&&(g.url_params[a.attr("name")]=a.val()),("month"===g.view||"day"===g.view||"week"===g.view||g.recurrence)&&g.pushcount++):(g.params[a.attr("name")]=a.val(),"map"!==g.view&&(g.url_params[a.attr("name")]=a.val()),"month"!==g.view&&"day"!==g.view&&"week"!==g.view||g.pushcount++))})});var v=c('#tribe-events-bar [class^="tribe-bar-button-"]'),w=v.next(".tribe-bar-drop-content");v.click(function(){var a=c(this);return a.toggleClass("open"),a.next(".tribe-bar-drop-content").toggle(),!1}),c(b).click(function(){c("#tribe-bar-views").removeClass("tribe-bar-views-open"),v.hasClass("open")&&(v.removeClass("open"),w.hide())}),w.click(function(a){a.stopPropagation()}),i&&debug.info("TEC Debug: tribe-events-bar.js successfully loaded")})}(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);